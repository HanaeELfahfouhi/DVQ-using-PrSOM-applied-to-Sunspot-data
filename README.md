# DVQ-using-PrSOM-applied-to-Sunspot-data
The Double Vector Quantization (DVQ) model enhanced by Probabilistic Self-Organizing Maps (PrSOM) is a two-phase approach dedicated to time series forecasting. This method begins by transforming the original series into two spaces: the regressor space, which contains vectors of consecutive past observations, and the deformation space, which captures the variation between successive regressors. Both spaces are clustered separately using the PrSOM algorithm, which not only identifies representative prototypes but also provides probabilistic associations, offering a more nuanced understanding of the underlying data structure. After clustering, a transition matrix is constructed to represent the likelihood of moving from a regressor cluster to a deformation cluster, effectively capturing the temporal evolution dynamics of the series. For forecasting, the current regressor is mapped to its most probable cluster, and the model uses the learned transition probabilities to determine the most likely deformation cluster. The predicted future regressor is then generated by applying the corresponding deformation prototype, from which the next value in the time series is extracted. This integration of probabilistic clustering and transition modeling allows DVQ-PrSOM to effectively capture both the structure and the dynamics of complex time series, providing reliable predictions even in non-linear and non-stationary environments such as sunspot activity. The data is available on Kaggle from the link: https://www.kaggle.com/code/razamh/sunspot-time-series-data 

The proposed Double Vector Quantization (DVQ) based on PrSOM code is structured as follows:

### 1. Input and Preprocessing

Given a univariate time series:

$$
x = (x_1, x_2, \ldots, x_n)
$$

- Build regressors $\mathbf{x}_t \in \mathbb{R}^p$ using a sliding window of size $\( p \)$.
- Compute deformation vectors:

$$
z_t = x_{t+1} - x_t
$$

### 2. Learning Phase (Training)

- Apply **Probabilistic Self-Organizing Map (PrSOM)** to cluster:
  - The regressor space $\{\mathbf{x}_t\}$ into $n_1$ clusters.
  - The deformation space  $\{ \mathbf{z}_t \}$  into $n_2$ clusters.

- Construct the **transition matrix**:

$$
T(i, j) = \mathbb{P}(\text{Deformation cluster } j \mid \text{Regressor cluster } i)
$$

using the observed transitions between clusters.

### 3. Prediction Phase

To forecast the next value $\hat{x}_{n+1}$, perform:

- Identify the most probable regressor cluster:

$$
k = \arg\max_{i}~p_i(\mathbf{x}_n)
$$

- Select the most likely deformation cluster:

$$
l = \arg\max_{j}~T(k, j)
$$

- Compute the next regressor:

$$
\hat{\mathbf{x}}_{n+1} = \mathbf{x}_n + \bar{\mathbf{z}}_l
$$

- Extract the last prediction component: $\hat{x}_{n+1}^{(p)}$ from the predicted vector.


### 4. Calculation of Prediction Errors
   
- The root mean square error (RMSE) is computed: 

$$\text{RMSE} = \sqrt{ \frac{1}{N} \sum_{i=1}^{N} \left( \hat{x}_i - x_i \right)^2 }$$
